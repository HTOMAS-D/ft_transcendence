<div id="login" class="container align-center col-4 my-2 p-2 card">
    <h1 class="text-center">Profile</h1>

    <!-- Profile picture -->
    <div class="row justify-content-center mb-3">
        <canvas class="border border-primary rounded-circle h-100 col-3 p-0 mb-3" width=128 height=128></canvas>
    </div>
    <input type="file" class="form-control hide" style="display: none">
    <!-- General information -->
    <hr>
    <div class="mb-3 form-floating">
        <input class="form-control" type="text" name="username" id="i_username" placeholder="" value="username" disabled>
        <label for="i_username" class="form-label">Username</label>
    </div>
    <div class="mb-3 form-floating">
        <input class="form-control" type="email" name="email" id="i_email" placeholder="" value="email@email.com" disabled>
        <label for="i_email" class="form-label">Email</label>
    </div>
    <!-- Password -->
    <hr class="hide" style="display: none">
    <div class="input-group mb-3 hide" style="display: none">
        <div class="form-floating">
            <input class="form-control" type="password" name="password" id="i_password" placeholder="" disabled>
            <label for="i_password" class="form-label">Current Password</label>
        </div>
        <button type="button" class="btn btn-outline-secondary border-light-subtle" onclick="passwordToggle('i_password', 'i_password_show')" id="i_password_show"><i class="fa fa-eye-slash" disabled></i></button>
    </div>

    <div class="input-group mb-3 hide" style="display: none">
        <div class="form-floating">
            <input class="form-control" type="password" name="new_password" id="i_new_password" placeholder="" disabled>
            <label for="i_new_password" class="form-label">New Password</label>
        </div>
        <button type="button" class="btn btn-outline-secondary border-light-subtle" onclick="passwordToggle('i_new_password', 'i_new_password_show')" id="i_new_password_show"><i class="fa fa-eye-slash"></i></button>
    </div>

    <div class="input-group mb-3 hide" style="display: none">
        <div class="form-floating">
            <input class="form-control" type="password" name="new_password_validation" id="i_new_password_validation" placeholder="" disabled>
            <label for="i_new_password_validation" class="form-label">Repeat New Password</label>
        </div>
        <button type="button" class="btn btn-outline-secondary border-light-subtle" onclick="passwordToggle('i_new_password_validation', 'i_new_password_validation_show')" id="i_new_password_validation_show"><i class="fa fa-eye-slash"></i></button>
    </div>

    <div class="row mb-3 mx-0">
        <button type="button" class="btn btn-primary btn-lg" id="stateBtn" onclick="changeState()">edit</button>
    </div>
    <hr>
    <div class="row mx-0">
        <button type="button" class="btn btn-primary btn-lg">totp</button>
    </div>

    <script src="scripts/userInfo.js"></script>

    <script>
        state = "view";

        inputs = {
            stateBtn: document.getElementById("stateBtn"),
            username: document.getElementById("i_username"),
            email:    document.getElementById("i_email"),
            cur_password:   document.getElementById("i_password"),
            new_password:   document.getElementById("i_new_password"),
            new_password_v: document.getElementById("i_new_password_validation"),
        };

        function changeState()
        {
            btn = document.getElementById("edit");
            if (state == "view") // Go to edit state
            {
                // Show all hidden elements
                elements = document.getElementsByClassName("hide")
                Array.from(elements).forEach(e => {
                    e.removeAttribute("style");
                });

                // Enable input fields
                inputs.username.disabled = false;
                inputs.email.disabled = false;
                inputs.cur_password.disabled = false;
                inputs.new_password.disabled = false;
                inputs.new_password_v.disabled = false;

                // Update the state and the stateBtn
                inputs.stateBtn.innerText = "save";
                state = "edit";
            }
            else if (state == "edit")
            {
                // Show hidden elements
                elements = document.getElementsByClassName("hide")
                Array.from(elements).forEach(e => {
                    e.setAttribute("style", "display: none");
                });

                inputs.username.disabled = true;
                inputs.email.disabled = true;
                inputs.cur_password.disabled = true;
                inputs.new_password.disabled = true;
                inputs.new_password_v.disabled = true;

                // TODO: Update user information on the server

                // Update state and stateBtn
                inputs.stateBtn.innerText = "edit";
                state = "view";
            }
        }
    </script>
</div>